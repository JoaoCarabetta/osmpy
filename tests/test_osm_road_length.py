import osm_road_length
from shapely import wkt
import pandas


def test_get():

    geometry = wkt.loads(
        "MULTIPOLYGON (((-116.958747158774 32.5487689268803,-114.725413971817 32.716253029889,-114.808747299689 32.4912530145175,-111.100414209405 31.3329196020495,-108.208747732263 31.3329196020495,-108.208394146121 31.7829196327925,-106.52544985856 31.7829196327925,-104.925414614124 30.6051089936204,-104.517081307554 29.6329194859095,-103.28593 28.97678,-102.867081415697 29.2162527907771,-102.675414761593 29.7412528266439,-102.318872777119 29.8745861690862,-101.400414845158 29.7662528283518,-100.675414892676 29.1011469060081,-100.283748251679 28.2579193919727,-99.5170816352613 27.5716568597988,-99.44583 27.0216,-99.0920816631165 26.3995859316823,-98.19492 26.05339,-97.6670817565132 26.0329192399658,-97.4337484384729 25.8412525602049,-97.1420817909225 25.957919234842,-97.6754150893003 24.516252469684,-97.8670817434049 22.4162523262169,-97.7004150876618 21.9579189615713,-97.3254151122399 21.5745856020495,-97.4170817728986 21.2245855781383,-97.1587484564968 20.6329188710504,-96.4504151695887 19.8662521520068,-96.2920818466328 19.3162521144321,-95.9170818712109 18.8745854175918,-94.8087486105194 18.5412520614859,-94.5254152957562 18.1579187019641,-92.9087487350483 18.4412520546541,-92.3837487694576 18.6745854039283,-91.9420821317385 18.6995854056362,-91.8504154710798 18.5079187258753,-91.5254154923808 18.4495853885568,-91.2420821776176 18.7079187395389,-91.3670821694249 18.8662520836892,-91.4754154956579 18.77458541076,-91.5004154940193 18.799585412468,-90.725415544814 19.3579187839453,-90.7087488792397 19.6829188061486,-90.4587488956251 19.9412521571307,-90.508748892348 20.5079188625107,-90.3337489038178 21.0245855644748,-89.8504156021629 21.2579189137489,-88.1670823791578 21.6245856054654,-87.2420824397837 21.4245855918019,-87.1087491151893 21.5412522664389,-87.3837490971653 21.4995855969257,-87.4004157627396 21.5245855986336,-87.0837491168278 21.6079189376601,-86.8504157987875 21.4412522596072,-86.8420824660003 21.2495855798463,-86.7920824692774 21.4079189239966,-86.7337491397673 21.1329189052092,-87.4254157611011 20.216252175918,-87.4670824250369 19.7745854790777,-87.7420824070129 19.6579188044406,-87.6587490791414 19.507918794193,-87.4587490922497 19.649585470538,-87.4087490955268 19.5579187976089,-87.6504157463542 19.3412521161401,-87.6670824119286 19.1912521058924,-87.5254157545469 19.3745854517506,-87.4420824266754 19.2995854466268,-87.8420824004588 18.1855876003555,-88.0837490512862 18.49125205807,-88.0087490562019 18.6495854022203,-88.0670823857119 18.8579187497865,-88.860277 17.894105,-89.037521 18.005122,-89.151901 17.815629,-90.987716 17.815344,-90.987447 17.251299,-91.434554 17.232897,-90.714251 16.727064,-90.631162 16.478371,-90.389878 16.413297,-90.426501 16.09888,-91.731518 16.073893,-92.210531 15.260619,-92.05933 15.069636,-92.2337487792889 14.5329184543126,-94.1254153219728 16.2162519026473,-94.2087486498443 16.1579185653288,-93.9670819990169 15.9912518872758,-94.5337486285433 16.1912519009394,-95.1504152547927 16.1829185670367,-96.2337485171227 15.6745851989752,-96.575415161396 15.6579185311699,-97.2170817860069 15.9245852160547,-97.7920817483205 15.9745852194705,-98.5587483647386 16.3079185755764,-98.7754150172047 16.5495852587532,-99.6420816270686 16.6829186011956,-101.067081533672 17.2579186404782,-101.942081476323 17.9579186883006,-102.192081459938 17.9079186848847,-103.367081382926 18.2579187087959,-103.850414684581 18.7829187446627,-105.042081273144 19.3829187856533,-105.508747909225 19.9995854944492,-105.70041456333 20.4162521895816,-105.250414592823 20.5745855337319,-105.333747920695 20.7495855456874,-105.542081240374 20.782918881298,-105.242081260036 21.0579189000854,-105.192081263313 21.4662522613151,-105.625414568245 21.9329189598634,-105.825414555137 22.6579190093937,-106.433747848599 23.1745857113578,-106.933747815828 23.8829190930828,-108.017081078158 24.657919146029,-108.067081074881 25.082919175064,-108.342081056857 25.1579191801879,-108.783747694576 25.3745858616567,-108.775414361789 25.532919205807,-109.050414343765 25.4579192006832,-109.06708100934 25.5829192092229,-109.400414320826 25.6329192126388,-109.283747661806 25.7079192177626,-109.400414320826 25.674585882152,-109.450414317549 25.9329192331341,-109.283747661806 26.5329192741247,-109.517080979846 26.7495859555935,-109.783747629035 26.7079192860803,-109.975414283139 27.0579193099915,-110.592080909389 27.2995859931682,-110.483747583156 27.3245859948762,-110.633747573325 27.6079193475662,-110.550414245453 27.8579193646456,-111.108747542192 27.9329193697694,-112.175414138948 28.957919439795,-112.233747468458 29.3079194637062,-112.417080789776 29.3412527993168,-112.383747458627 29.4912528095645,-112.750414101262 29.9079195046968,-112.758747434049 30.1912528573868,-113.100414078322 30.6912528915457,-113.100414078322 31.1829195918019,-113.6337473767 31.3245862681469,-113.642080709487 31.4745862783945,-113.900414025889 31.6162529547395,-114.175414007865 31.4912529461998,-114.583747314436 31.7495862971819,-114.642080643946 31.6579196242528,-114.808747299689 31.7412529632792,-114.883747294773 31.1245862544833,-114.708747306243 30.9245862408198,-114.575413981648 30.0329195132365,-113.6337473767 29.2912527959009,-113.533747383254 28.9079194363792,-113.225414070129 28.841252765158,-113.092080745535 28.4995860751494,-112.84208076192 28.4412527378309,-112.692080771752 27.7412526900085,-111.950414153695 27.0995859795047,-112.008747483205 26.9662526370623,-111.75874749959 26.54958594193,-111.825414161888 26.8995859658412,-111.442080853679 26.524585940222,-111.308747529084 25.7829192228864,-111.008747548747 25.5162525380017,-110.650414238899 24.8079191562767,-110.67541423726 24.3495857916311,-110.3254142602 24.1662524457728,-110.333747592987 24.3412524577284,-110.225414266754 24.3495857916311,-109.975414283139 24.0412524372331,-109.825414292971 24.0662524389411,-109.683747635589 23.6495857438087,-109.467080983123 23.5662524047822,-109.450414317549 23.1912523791631,-109.992080948714 22.8745856908625,-110.3254142602 23.5579190708796,-111.250414199574 24.232919116994,-111.675414171719 24.3495857916311,-111.483747517614 24.3662524594364,-111.683747504506 24.5829191409052,-111.825414161888 24.5079191357814,-112.133747475012 24.8495858257899,-112.058747479928 24.541252471392,-112.108747476651 24.5579191391973,-112.308747463543 24.8079191562767,-112.092080811077 25.2745858548249,-112.100414143864 25.7412525533732,-112.350414127478 26.1829192502135,-113.133747409471 26.6329192809564,-113.083747412748 26.6745859504697,-113.158747407832 26.7912526251067,-113.133747409471 26.6579192826644,-113.267080734065 26.6995859521776,-113.142080742258 26.8579192963279,-113.158747407832 26.9829193048676,-113.258747401278 26.7495859555935,-113.617080711126 26.7079192860803,-113.833747363592 26.9579193031597,-114.433747324267 27.1662526507259,-114.533747317713 27.4329193356106,-115.025413952155 27.7329193561059,-115.06708061609 27.8662526985482,-114.492080653777 27.7745860256191,-114.292080666885 27.8745860324509,-114.117080678355 27.6245860153715,-113.958747355399 27.6579193509821,-114.275414001311 27.8829193663535,-114.142080676716 28.0912527139197,-114.075414014419 27.9995860409906,-114.042080683271 28.0245860426985,-114.050414016058 28.4662527395389,-114.967080622645 29.3745861349274,-115.700413907914 29.7495861605465,-115.808747234147 30.2912528642186,-116.050413884975 30.4579195422716,-116.067080550549 30.8079195661827,-116.342080532525 30.9579195764304,-116.317080534164 31.1662529239966,-116.692080509585 31.5495862835184,-116.742080506308 31.7495862971819,-116.658747178437 31.724586295474,-116.617080514501 31.8495863040137,-116.88374716369 32.007919648164,-117.100413816156 32.3995863415884,-117.125413814517 32.5329196840307,-116.958747158774 32.5487689268803)))"
    )
    data = osm_road_length.get(geometry)

    assert isinstance(data, pandas.core.frame.DataFrame)
    assert len(data) > 0
